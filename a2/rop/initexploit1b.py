import sys
import struct

def main(args):
    fdump = open("dump1", "rb")
    sdump = fdump.read()
    sdumpslice = sdump[94:100]
    sdumpslice += '\x00\x00'
    ebpaddr = struct.unpack('<Q', sdumpslice)
    print("initexploit1b.py: Extracted EBP address")

    fdump.close()

    return "0x{:08x}".format(ebpaddr[0])

if __name__ == '__main__':
    main(sys.argv)
